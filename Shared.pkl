import "./Config.pkl"
import "./Builtins.pkl"

actionlint = (Builtins.actionlint) {
  // extend to include actiion.yml/yaml files XXX turned out this is not supported by actionlint at the moment
  // glob = List(".github/workflows/*.yml", ".github/workflows/*.yaml", "action.yml", "action.yaml")

  // exclude managed tf- files which are generated
  exclude = List(".github/workflows/tf-*")
}

prettier = (Builtins.prettier) {
  // exclude files which are generated/managed
  exclude = List(".github/workflows/tf-*", "CHANGELOG.md")
}

pkl = new Config.Step {
  glob = "*.pkl"
  check = new Config.Script {
    linux = "pkl eval {{files}} >/dev/null"
    macos = "pkl eval {{files}} >/dev/null"
    windows = "pkl eval {{files}} >nul"
  }
}

spotlessGradle = new Config.Step {
  // define relevant file types for default Spotless configuration to avoid unnecessary runs
  glob = List("*.gradle", "*.java", "*.scala", "*.sc", "*.groovy", "*.kt", "*.kts", "*.md")

  check = new Config.Script {
    linux = "./gradlew spotlessCheck"
    macos = "./gradlew spotlessCheck"
    windows = "gradlew.bat spotlessCheck"
  }

  fix = new Config.Script {
    linux = "./gradlew spotlessApply"
    macos = "./gradlew spotlessApply"
    windows = "gradlew.bat spotlessApply"
  }

  // Only run if Gradle wrapper exists - FIXME does this work with Windows?
  // condition = "test -d gradle/wrapper" FIXME does not actually work like this - based on outdated example
  //TODO reevaluate at a later time if we can add such a condition, for now we assume if this is imported, the project uses Gradle
}
