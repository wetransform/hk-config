{
  $schema: "https://docs.renovatebot.com/renovate-schema.json",
  extends: ["github>wetransform/renovate-config:self-hosted.json5"],
  packageRules: [
    // Group hk and pkl dependencies separately (mise tools and references in pkl files)
    {
      groupName: "hk",
      groupSlug: "jdx-hk",
      matchDepNames: ["hk", "jdx/hk"],
    },
    {
      groupName: "pkl",
      groupSlug: "apple-pkl",
      matchDepNames: ["pkl", "apple/pkl"],
    },
  ],
  customManagers: [
    {
      description: "Version variables in pkl files",
      customType: "regex",
      managerFilePatterns: ["**/*.pkl"],
      matchStrings: [
        '.*renovate:\\s*datasource=(?<datasource>.*?)\\s*depName=(?<depName>.*?)\n.*(?:local\\s+)?(?<varName>\\w+)_version\\s*=\\s*"?(?<currentValue>[^"\n]+)"?',
      ],
      extractVersionTemplate: "^v?(?<version>.*)$",
    },
    {
      description: "Versions of hk in pkl import/amends",
      customType: "regex",
      managerFilePatterns: ["Builtins.pkl", "Config.pkl"],
      matchStrings: [
        '(amends|import)\\s+"package://github.com/jdx/hk/releases/download/v(?<currentValue>\\d+\\.\\d+\\.\\d+)/hk@(?<currentValue2>\\d+\\.\\d+\\.\\d+)#',
      ],
      depNameTemplate: "jdx/hk",
      datasourceTemplate: "github-releases",
      extractVersionTemplate: "^v?(?<version>.*)$",
    },
  ],
}
